// middleware to check if the user is authenticated